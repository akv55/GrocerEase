<% layout("/layouts/boilerplate") -%>
    <script>
        function removeFromCart(itemId) {
            fetch(`/cart/remove/${itemId}`, {
                method: 'DELETE',
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        window.location.reload();
                    } else {
                        alert('Failed to remove item from cart.');
                    }
                })
                .catch(error => console.error('Error:', error));
        }

        function checkout() {
            window.location.href = '/checkout';
        }
    </script>
    <div class="cart">
        <h1>Your Cart</h1>

        <% if (cartItems.length===0) { %>
            <p>Your cart is empty.</p>
            <% } else { %>
                <ul class="cart-items">
                    <% cartItems.forEach(item=> { %>
                        <li class="cart-item">
                            <div class="item-details">
                                <h2>
                                    <%= item.title %>
                                </h2>
                                <p>Price: ₹<%= item.price.toLocaleString("en-IN") %>
                                </p>
                                <p>Quantity: <%= item.quantity %>
                                </p>
                            </div>
                            <button class="remove-btn" onclick="removeFromCart('<%= item._id %>')">Remove</button>
                        </li>
                        <% }) %>
                </ul>
                <div class="cart-total">
                    <h2>Total: ₹<%= totalPrice.toLocaleString("en-IN") %>
                    </h2>
                    <button class="checkout-btn" onclick="checkout()">Checkout</button>
                </div>
                <% } %>
    </div>