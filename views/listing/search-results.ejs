<% layout("/layouts/boilerplate") -%>
    <% if (typeof filterType !== 'undefined' && filterType === 'category') { %>
        <h2 style="margin-left: 50px; color: #666;">Products in "<%= query %>" category</h2>
    <% } else if (typeof filterType !== 'undefined' && filterType === 'all') { %>
        <h2 style="margin-left: 50px; color: #666;"><%= query %></h2>
    <% } else { %>
        <h2 style="margin-left: 50px; color: #666;">Search results for "<%= query %>"</h2>
    <% } %>
    
    <% if (results && results.length > 0) { %>
        <p style="margin-left: 50px; color: #888;">Found <%= results.length %> product(s)</p>
    <% } else { %>
        <p style="margin-left: 50px; color: #888;">No products found</p>
    <% } %>
    
    <div class="listing-card-container">
        <% for(let product of results){ %>
            <a href="/<%=product.slug%>" class="listing-link">

                <div class="listing-card">
                    <!-- Image Container -->
                    <div class="listing-image-container">
                        <img src="<%= product.image && product.image.url ? product.image.url : '/assets/img.jpg' %>"
                            class="listing-image" alt="<%= product.title %>" />
                    </div>
                    <!-- Wishlist Button -->
                    <form action="/wishlist/add/<%= product._id %>" method="POST" class="wishlist-form">
                        <button type="submit" class="wishlist-btn" title="Add to Wishlist">
                            <i class="fas fa-heart"></i>
                        </button>
                    </form>
                    <!-- Card Body -->
                    <div class="listing-card-info">
                        <!-- Category -->
                        <div class="listing-category">
                            <%= product.category && product.category.name ? product.category.name : 'Unknown' %>
                        </div>
                        <!-- Title -->
                        <h3 class="listing-title">
                            <%= product.title %>
                        </h3>
                        <!-- Rating -->
                        <div class="rating">
                            <div class="stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                            </div>
                            <span class="rating-count">(4.5)</span>
                        </div>
                        <!-- Product Details -->
                        <div class="listing-details">
                            <div class="listing-quantity">
                                <%= product.weight.value || '' %>
                                    <%= product.weight.unit || '' %>
                            </div>
                            <div class="listing-location">
                                <i class="fas fa-map-marker-alt"></i>
                                <%= product.location || 'Local' %>
                            </div>
                        </div>
                        <div class="listing-price">
                            <span class="currency">â‚¹</span>
                            <%= product.price ? product.price.toLocaleString("en-IN") : "0" %>
                        </div>
                        <!-- Footer -->
                        <!-- <div class="listing-footer">
                            <% if (product && product._id) { %>
                                <form action="/cart/add/<%= product._id %>" method="POST">
                                    <button type="submit" class="btn-add">Add to Cart</button>
                                </form>
                                <% } else { %>
                                    <p style="color: red;">Product data not available.</p>
                                    <% } %>
                                        <button class="btn-buy" onclick="">
                                            Buy Now
                                        </button>
                        </div> -->
                    </div>
                </div>

            </a>


            <% } %>

    </div>
    
    <% if (results.length === 0) { %>
        <p>No products found for "<%= query %>"</p>
    <% } %>